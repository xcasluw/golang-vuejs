(function(){"use strict";var e={4769:function(e,t,o){var a=o(9242),r=o(3396);function s(e,t,o,a,s,n){const l=(0,r.up)("Header"),i=(0,r.up)("router-view"),u=(0,r.up)("Footer");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(l),(0,r._)("div",null,[((0,r.wg)(),(0,r.j4)(i,{key:s.componentKey,onSuccess:n.success,onError:n.error,onWarning:n.warning,onForceUpdate:n.forceUpdate},{default:(0,r.w5)((({Component:e})=>[((0,r.wg)(),(0,r.j4)(r.Ob,{include:"BooksComposition"},[((0,r.wg)(),(0,r.j4)((0,r.LL)(e)))],1024))])),_:1},8,["onSuccess","onError","onWarning","onForceUpdate"]))]),(0,r.Wm)(u)],64)}var n=o(7139);const l={class:"navbar navbar-expand-lg navbar-dark bg-dark"},i={class:"container-fluid"},u=(0,r._)("a",{class:"navbar-brand",href:"#"},"Navbar",-1),c=(0,r._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,r._)("span",{class:"navbar-toggler-icon"})],-1),d={class:"collapse navbar-collapse",id:"navbarNav"},m={class:"navbar-nav me-auto mb-2 mb-lg-0"},p={class:"nav-item"},h=(0,r.Uk)("Home"),v={class:"nav-item"},g=(0,r.Uk)("Books"),b={key:0,class:"nav-item dropdown"},k=(0,r._)("a",{href:"#",class:"nav-link dropdown-toggle",id:"navBarDropDown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},"Admin",-1),f={class:"dropdown-menu","aria-labelledby":"navBarDropDown"},_=(0,r.Uk)("Manage Users"),w=(0,r.Uk)("Add User"),y=(0,r.Uk)("Manage Books"),C=(0,r.Uk)("Add Book"),D={class:"nav-item"},x=(0,r.Uk)("Login"),$={class:"navbar-text"};function U(e,t,o,a,s,U){const I=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("nav",l,[(0,r._)("div",i,[u,c,(0,r._)("div",d,[(0,r._)("ul",m,[(0,r._)("li",p,[(0,r.Wm)(I,{class:"nav-link","aria-current":"page",to:"/"},{default:(0,r.w5)((()=>[h])),_:1})]),(0,r._)("li",v,[(0,r.Wm)(I,{class:"nav-link active",to:"/books"},{default:(0,r.w5)((()=>[g])),_:1})]),""!=s.store.token?((0,r.wg)(),(0,r.iD)("li",b,[k,(0,r._)("ul",f,[(0,r._)("li",null,[(0,r.Wm)(I,{class:"dropdown-item",to:"/admin/users"},{default:(0,r.w5)((()=>[_])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(I,{class:"dropdown-item",to:"/admin/users/0"},{default:(0,r.w5)((()=>[w])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(I,{class:"dropdown-item",to:"/admin/books"},{default:(0,r.w5)((()=>[y])),_:1})]),(0,r._)("li",null,[(0,r.Wm)(I,{class:"dropdown-item",to:{name:"BookEdit",params:{bookId:0}}},{default:(0,r.w5)((()=>[C])),_:1})])])])):(0,r.kq)("",!0),(0,r._)("li",D,[""===s.store.token?((0,r.wg)(),(0,r.j4)(I,{key:0,class:"nav-link",to:"/login"},{default:(0,r.w5)((()=>[x])),_:1})):((0,r.wg)(),(0,r.iD)("a",{key:1,href:"javascript:void(0);",class:"nav-link",onClick:t[0]||(t[0]=(...e)=>U.logout&&U.logout(...e))},"Logout"))])]),(0,r._)("span",$,(0,n.zw)(s.store.user.first_name??""),1)])])])}var I=o(4870);const q=(0,I.qj)({token:"",user:{}});var j=o(2483),S=o.p+"img/book-and-glasses.f0be775c.png";const T={class:"container"},V=(0,r._)("div",{class:"row"},[(0,r._)("div",{class:"col"},[(0,r._)("img",{src:S,alt:"Book and glasses",class:"img-fluid mt-5"})])],-1),F=[V];function O(e,t,o,a,s,n){return(0,r.wg)(),(0,r.iD)("div",T,F)}var H={},W=o(89);const E=(0,W.Z)(H,[["render",O]]);var B=E;const A={class:"container"},L={class:"row"},z={class:"col"},P=(0,r._)("h1",{class:"mt-5"},"Login",-1),N=(0,r._)("hr",null,null,-1),M=(0,r._)("hr",null,null,-1),Z=(0,r._)("input",{type:"submit",class:"btn btn-primary",value:"Login"},null,-1);function Y(e,t,o,a,s,n){const l=(0,r.up)("TextInputComponent"),i=(0,r.up)("FormTagComponent");return(0,r.wg)(),(0,r.iD)("div",A,[(0,r._)("div",L,[(0,r._)("div",z,[P,N,(0,r.Wm)(i,{onMyevent:a.submitHandler,name:"myForm",event:"myevent"},{default:(0,r.w5)((()=>[(0,r.Wm)(l,{modelValue:a.email,"onUpdate:modelValue":t[0]||(t[0]=e=>a.email=e),label:"Email",type:"email",name:"email",required:"true"},null,8,["modelValue"]),(0,r.Wm)(l,{modelValue:a.password,"onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),label:"Password",type:"password",name:"password",required:"true"},null,8,["modelValue"]),M,Z])),_:1},8,["onMyevent"])])])])}const K=["event","method","action"];function R(e,t,o,s,n,l){return(0,r.wg)(),(0,r.iD)("form",{onSubmit:t[0]||(t[0]=(0,a.iM)(((...e)=>l.submit&&l.submit(...e)),["prevent"])),ref:o.name,event:o.event,autocomplete:"off",method:o.method,action:o.action,class:"needs-validation",novalidate:""},[(0,r.WI)(e.$slots,"default")],40,K)}var J={name:"FormTagComponent",props:["method","action","name","event"],methods:{submit(){let e=this.$refs[this.$props.name];e.checkValidity()&&this.$emit(this.$props.event),e.classList.add("was-validated")}}};const G=(0,W.Z)(J,[["render",R]]);var Q=G;const X={class:"mb-3"},ee=["for"],te=["type","name","placeholder","required","min","max","value","autocomplete"],oe={class:"form-text"};function ae(e,t,o,a,s,l){return(0,r.wg)(),(0,r.iD)("div",X,[(0,r._)("label",{for:o.name,class:"form-label"},(0,n.zw)(o.label),9,ee),(0,r._)("input",{type:o.type,name:o.name,placeholder:o.placeholder,required:o.required,min:o.min,max:o.max,value:o.modelValue,autocomplete:o.name+"-new",onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value)),class:"form-control"},null,40,te),(0,r._)("div",oe,(0,n.zw)(o.help),1)])}var re={name:"TextInput",props:{name:String,type:String,label:String,placeholder:String,required:String,min:String,max:String,modelValue:String,help:String}};const se=(0,W.Z)(re,[["render",ae]]);var ne=se;let le={requireToken:function(){if(""===q.token)return Oo.push("/login"),!1},requestOptions:function(e){const t=new Headers;return t.append("Content-Type","application/json"),t.append("Authorization","Bearer "+q.token),{method:"POST",body:JSON.stringify(e),headers:t}},checkToken:function(){if(""!==q.token){const e={token:q.token},t=new Headers;t.append("Content-Type","application/json");let o={method:"POST",body:JSON.stringify(e),headers:t};fetch("http://localhost:8082/validate-token",o).then((e=>e.json())).then((e=>{e.error?console.log(e.error):e.data||(q.token="",q.user={},document.cookie="_site_data=; Path=/; SameSite=strict; Secure; Expires=Thu, 01 Jan 1970 00:00:01 GMT;")}))}}};var ie=le,ue={name:"LoginComposition",props:{},emits:["error"],components:{FormTagComponent:Q,TextInputComponent:ne},setup(e,t){let o=(0,I.iH)(""),a=(0,I.iH)("");function s(){const e={email:o.value,password:a.value};fetch("http://localhost:8082/users/login",ie.requestOptions(e)).then((e=>e.json())).then((e=>{if(e.error)t.emit("error",e.message);else{q.token=e.data.token.token,q.user={id:e.data.user.id,first_name:e.data.user.first_name,last_name:e.data.user.last_name,email:e.data.user.email};let t=new Date,o=1;t.setTime(t.getTime()+24*o*60*60*1e3);const a="expires="+t.toUTCString();document.cookie="_site_data="+JSON.stringify(e.data)+"; "+a+"; path=/; SameSite=strict; Secure;",Oo.push("/")}}))}return(0,r.bv)((()=>{console.log("using new component")})),{submitHandler:s,email:o,password:a}}};const ce=(0,W.Z)(ue,[["render",Y]]);var de=ce;const me=e=>((0,r.dD)("data-v-ef5739fe"),e=e(),(0,r.Cn)(),e),pe={class:"container"},he={class:"row"},ve=me((()=>(0,r._)("div",{class:"col"},[(0,r._)("h1",{class:"mt-3"},"Books")],-1))),ge=me((()=>(0,r._)("hr",null,null,-1))),be={class:"filters text-center"},ke=me((()=>(0,r._)("hr",null,null,-1))),fe={key:0},_e={class:"card-group"},we=me((()=>(0,r._)("br",null,null,-1))),ye={key:0,class:"card me-2 ms-1 mb-3",style:{width:"10rem"}},Ce=["src","alt"],De={class:"card-body text-center"},xe={class:"card-title"},$e={class:"book-author"},Ue=me((()=>(0,r._)("br",null,null,-1))),Ie={class:"me-1"},qe=(0,r.Uk)(","),je={key:1};function Se(e,t,o,s,l,i){const u=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",pe,[(0,r._)("div",he,[ve,ge,(0,r._)("div",be,[(0,r._)("span",{class:(0,n.C_)(["filter me-1",{active:0===s.currentFilter}]),onClick:t[0]||(t[0]=e=>s.setFilter(0))},"ALL",2),(0,r._)("span",{class:(0,n.C_)(["filter me-1",{active:7===s.currentFilter}]),onClick:t[1]||(t[1]=e=>s.setFilter(7))},"CLASSIC",2),(0,r._)("span",{class:(0,n.C_)(["filter me-1",{active:2===s.currentFilter}]),onClick:t[2]||(t[2]=e=>s.setFilter(2))},"FANTASY",2),(0,r._)("span",{class:(0,n.C_)(["filter me-1",{active:6===s.currentFilter}]),onClick:t[3]||(t[3]=e=>s.setFilter(6))},"HORROR",2),(0,r._)("span",{class:(0,n.C_)(["filter me-1",{active:4===s.currentFilter}]),onClick:t[4]||(t[4]=e=>s.setFilter(4))},"THRILLER",2),(0,r._)("span",{class:(0,n.C_)(["filter me-1",{active:1===s.currentFilter}]),onClick:t[5]||(t[5]=e=>s.setFilter(1))},"SCIENCE FICTION",2)]),ke,s.ready?((0,r.wg)(),(0,r.iD)("div",fe,[(0,r._)("div",_e,[(0,r.Wm)(a.W3,{class:"p-3 d-flex flex-wrap",tag:"div",appear:"",name:"books"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.books,(e=>((0,r.wg)(),(0,r.iD)("div",{key:e.id},[we,e.genres.find((e=>e.id===s.currentFilter))||0===s.currentFilter?((0,r.wg)(),(0,r.iD)("div",ye,[(0,r.Wm)(u,{to:`/book/${e.slug}`},{default:(0,r.w5)((()=>[(0,r._)("img",{src:`${s.imgPath}/covers/${e.slug}.jpg`,class:"card-img-top",alt:`cover for ${e.title}`},null,8,Ce)])),_:2},1032,["to"]),(0,r._)("div",De,[(0,r._)("h6",xe,(0,n.zw)(e.title),1),(0,r._)("span",$e,(0,n.zw)(e.author.author_name),1),Ue,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.genres,((t,o)=>((0,r.wg)(),(0,r.iD)("small",{class:"text-muted book-genre",key:t.id},[(0,r._)("em",Ie,[(0,r.Uk)((0,n.zw)(t.genre_name)+" ",1),o!==e.genres.length-1?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[qe],64)):(0,r.kq)("",!0)])])))),128))])])):(0,r.kq)("",!0)])))),128))])),_:1})])])):((0,r.wg)(),(0,r.iD)("p",je,"Loading..."))])])}var Te={name:"BooksComposition",emits:["error"],props:{},setup(e,t){let o=(0,I.iH)(!1),a=(0,I.iH)(0);const s=(0,I.iH)("http://localhost:8082/static");let n=(0,I.iH)({});function l(e){a.value=e}return(0,r.bv)((()=>{fetch("http://localhost:8082/books").then((e=>e.json())).then((e=>{e.error?t.emit("error",e.message):(n.value=e.data.books,o.value=!0)})).catch((e=>{t.emit("error",e)}))})),{currentFilter:a,imgPath:s,books:n,setFilter:l,ready:o}}};const Ve=(0,W.Z)(Te,[["render",Se],["__scopeId","data-v-ef5739fe"]]);var Fe=Ve;const Oe={class:"container"},He={class:"row"},We={class:"col-md-2"},Ee=["src"],Be={class:"col-md-10"},Ae={class:"mt-3"},Le=(0,r._)("hr",null,null,-1),ze=(0,r._)("strong",null,"Author:",-1),Pe=(0,r._)("br",null,null,-1),Ne=(0,r._)("strong",null,"Published:",-1),Me={key:1};function Ze(e,t,o,a,s,l){return(0,r.wg)(),(0,r.iD)("div",Oe,[(0,r._)("div",He,[(0,r._)("div",We,[a.ready?((0,r.wg)(),(0,r.iD)("img",{key:0,class:"img-fluid img-thumbnail",src:`${a.imgPath}/covers/${a.book.slug}.jpg`,alt:"cover"},null,8,Ee)):(0,r.kq)("",!0)]),(0,r._)("div",Be,[a.ready?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[(0,r._)("h3",Ae,(0,n.zw)(a.book.title),1),Le,(0,r._)("p",null,[ze,(0,r.Uk)(" "+(0,n.zw)(a.book.author.author_name),1),Pe,Ne,(0,r.Uk)(" "+(0,n.zw)(a.book.publication_year),1)]),(0,r._)("p",null,(0,n.zw)(a.book.description),1)],64)):((0,r.wg)(),(0,r.iD)("p",Me,"Loading..."))])])])}var Ye={name:"BookComposition",emits:["error"],props:{},setup(e,t){let o=(0,I.iH)(!1);const a=(0,I.iH)("http://localhost:8082/static");let s=(0,I.iH)({});const n=(0,j.yj)();return(0,r.bv)((()=>{fetch(`http://localhost:8082/books/${n.params.bookName}`).then((e=>e.json())).then((e=>{e.error?t.emit("error",e.message):(s.value=e.data,o.value=!0)})).catch((e=>{t.emit("error",e)}))})),{book:s,ready:o,imgPath:a}}};const Ke=(0,W.Z)(Ye,[["render",Ze]]);var Re=Ke;const Je={class:"container"},Ge={class:"row"},Qe={class:"col"},Xe=(0,r._)("h1",{class:"mt-3"},"Manage Books",-1),et=(0,r._)("hr",null,null,-1),tt={key:0,class:"table table-striped table-compact"},ot=(0,r._)("thead",null,[(0,r._)("tr",null,[(0,r._)("th",null,"Book"),(0,r._)("th",null,"Author")])],-1);function at(e,t,o,a,s,l){const i=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",Je,[(0,r._)("div",Ge,[(0,r._)("div",Qe,[Xe,et,this.ready?((0,r.wg)(),(0,r.iD)("table",tt,[ot,(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(this.books,(e=>((0,r.wg)(),(0,r.iD)("tr",{key:e.id},[(0,r._)("td",null,[(0,r.Wm)(i,{to:`/admin/books/${e.id}`},{default:(0,r.w5)((()=>[(0,r.Uk)((0,n.zw)(e.title),1)])),_:2},1032,["to"])]),(0,r._)("td",null,(0,n.zw)(e.author.author_name),1)])))),128))])])):(0,r.kq)("",!0)])])])}var rt={name:"BooksAdmin",data(){return{books:{},ready:!1}},mounted(){ie.requireToken(),fetch("http://localhost:8082/books").then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.books=e.data.books,this.ready=!0)}))},deactivated(){this.ready=!1}};const st=(0,W.Z)(rt,[["render",at]]);var nt=st;const lt=e=>((0,r.dD)("data-v-0c8fbd26"),e=e(),(0,r.Cn)(),e),it={class:"container"},ut={class:"row"},ct={class:"col"},dt=lt((()=>(0,r._)("h1",{class:"mt-3"},"Add/Edit Book",-1))),mt=lt((()=>(0,r._)("hr",null,null,-1))),pt={key:0,class:"mb-3"},ht=["src"],vt={class:"mb-3"},gt=lt((()=>(0,r._)("label",{for:"formFile",class:"form-label"},"Cover Image",-1))),bt={class:"mb-3"},kt=lt((()=>(0,r._)("label",{for:"description",class:"form-label"},"Description",-1))),ft={class:"mb-3"},_t=lt((()=>(0,r._)("label",{for:"genres",class:"form-label"},"Genres",-1))),wt=["value"],yt=lt((()=>(0,r._)("hr",null,null,-1))),Ct={class:"float-start"},Dt=lt((()=>(0,r._)("input",{type:"submit",class:"btn btn-primary me-2",value:"Save"},null,-1))),xt=(0,r.Uk)("Cancel"),$t={class:"float-end"},Ut=lt((()=>(0,r._)("div",{class:"clearfix"},null,-1)));function It(e,t,o,s,l,i){const u=(0,r.up)("TextInput"),c=(0,r.up)("SelectInput"),d=(0,r.up)("router-link"),m=(0,r.up)("FormTag");return(0,r.wg)(),(0,r.iD)("div",it,[(0,r._)("div",ut,[(0,r._)("div",ct,[dt,mt,(0,r.Wm)(m,{onBookEditEvent:i.submitHandler,name:"bookForm",event:"bookEditEvent"},{default:(0,r.w5)((()=>[""!==this.book.slug?((0,r.wg)(),(0,r.iD)("div",pt,[(0,r._)("img",{src:`${this.imgPath}/covers/${this.book.slug}.jpg`,class:"img-fluid img-thumbnail book-cover",alt:"cover"},null,8,ht)])):(0,r.kq)("",!0),(0,r._)("div",vt,[gt,0===this.book.id?((0,r.wg)(),(0,r.iD)("input",{key:0,ref:"coverInput",class:"form-control",type:"file",id:"formFile",required:"",accept:"image/jpeg",onChange:t[0]||(t[0]=(...e)=>i.loadCoverImage&&i.loadCoverImage(...e))},null,544)):((0,r.wg)(),(0,r.iD)("input",{key:1,ref:"coverInput",class:"form-control",type:"file",id:"formFile",accept:"image/jpeg",onChange:t[1]||(t[1]=(...e)=>i.loadCoverImage&&i.loadCoverImage(...e))},null,544))]),(0,r.Wm)(u,{modelValue:l.book.title,"onUpdate:modelValue":t[2]||(t[2]=e=>l.book.title=e),type:"text",required:"true",label:"Title",value:l.book.title,name:"title"},null,8,["modelValue","value"]),(0,r.Wm)(c,{name:"author-id",modelValue:this.book.author_id,"onUpdate:modelValue":t[3]||(t[3]=e=>this.book.author_id=e),items:this.authors,required:"required",label:"Author"},null,8,["modelValue","items"]),(0,r.Wm)(u,{modelValue:l.book.publication_year,"onUpdate:modelValue":t[4]||(t[4]=e=>l.book.publication_year=e),type:"number",required:"true",label:"Publication Year",value:l.book.publication_year,name:"publication-year"},null,8,["modelValue","value"]),(0,r._)("div",bt,[kt,(0,r.wy)((0,r._)("textarea",{required:"","onUpdate:modelValue":t[5]||(t[5]=e=>l.book.description=e),class:"form-control",id:"description",rows:"3"},null,512),[[a.nr,l.book.description]])]),(0,r._)("div",ft,[_t,(0,r.wy)((0,r._)("select",{ref:"genres",id:"genres",class:"form-select",required:"",size:"7","onUpdate:modelValue":t[6]||(t[6]=e=>this.book.genre_ids=e),multiple:""},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(this.genres,(e=>((0,r.wg)(),(0,r.iD)("option",{value:e.value,key:e.value},(0,n.zw)(e.text),9,wt)))),128))],512),[[a.bM,this.book.genre_ids]])]),yt,(0,r._)("div",Ct,[Dt,(0,r.Wm)(d,{to:"/admin/books",class:"btn btn-outline-secondary"},{default:(0,r.w5)((()=>[xt])),_:1})]),(0,r._)("div",$t,[this.book.id>0?((0,r.wg)(),(0,r.iD)("a",{key:0,class:"btn btn-danger",href:"javascript:void(0)",onClick:t[7]||(t[7]=e=>i.confirmDelete(this.book.id))}," Delete ")):(0,r.kq)("",!0)]),Ut])),_:1},8,["onBookEditEvent"])])])])}const qt={class:"mb-3"},jt=["for"],St=["id","name","required","multiple","value"],Tt=(0,r._)("option",{disabled:"",value:""},"Choose...",-1),Vt=["value"];function Ft(e,t,o,a,s,l){return(0,r.wg)(),(0,r.iD)("div",qt,[(0,r._)("label",{for:o.name,class:"form-label"},(0,n.zw)(o.label),9,jt),(0,r._)("select",{id:o.name,class:"form-select",name:o.name,required:o.required,multiple:o.multiple,value:o.modelValue,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value))},[Tt,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.items,(e=>((0,r.wg)(),(0,r.iD)("option",{value:e.value,key:e.value},(0,n.zw)(e.text),9,Vt)))),128))],40,St)])}var Ot={name:"SelectInput",props:["items","name","required","label","modelValue","multiple"],emits:["update:modelValue"]};const Ht=(0,W.Z)(Ot,[["render",Ft]]);var Wt=Ht,Et=o(602),Bt=o.n(Et),At={name:"BookEdit",beforeMount(){ie.requireToken(),this.$route.params.bookId>0&&fetch(`http://localhost:8082/admin/books/${this.$route.params.bookId}`,ie.requestOptions("")).then((e=>e.json())).then((e=>{if(e.error)this.$emit("error",e.message);else{this.book=e.data;let t=[];for(let e=0;e<this.book.genres.length;e++)t.push(this.book.genres[e].id);this.book.genre_ids=t}})).catch((e=>{this.$emit("error",e)})),fetch("http://localhost:8082/admin/authors/all",ie.requestOptions("")).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):this.authors=e.data})).catch((e=>{this.$emit("error",e)}))},components:{FormTag:Q,TextInput:ne,SelectInput:Wt},data(){return{book:{id:0,title:"",author_id:0,publication_year:null,description:"",cover:"",slug:"",genres:[],genre_ids:[]},authors:[],imgPath:"http://localhost:8082/static",genres:[{value:1,text:"Science Fiction"},{value:2,text:"Fantasy"},{value:3,text:"Romance"},{value:4,text:"Thriller"},{value:5,text:"Mystery"},{value:6,text:"Horror"},{value:7,text:"Classic"}]}},methods:{submitHandler(){const e={id:this.book.id,title:this.book.title,author_id:parseInt(this.book.author_id,10),publication_year:parseInt(this.book.publication_year,10),description:this.book.description,cover:this.book.cover,slug:this.book.slug,genre_ids:this.book.genre_ids};fetch("http://localhost:8082/admin/books/save",ie.requestOptions(e)).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.$emit("success","Changes saved"),Oo.push("/admin/books"))})).catch((e=>{this.$emit("error",e)}))},loadCoverImage(){const e=this.$refs.coverInput.files[0],t=new FileReader;t.onloadend=()=>{const e=t.result.replace("data:","").replace(/^.+,/,"");this.book.cover=e},t.readAsDataURL(e)},confirmDelete(e){Bt().confirm({text:"Are you sure you want to delete this book?",submitText:"Delete",submitCallback:()=>{let t={id:e};fetch("http://localhost:8082/admin/books/delete",ie.requestOptions(t)).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.$emit("success","Book deleted"),Oo.push("/admin/books"))}))}})}}};const Lt=(0,W.Z)(At,[["render",It],["__scopeId","data-v-0c8fbd26"]]);var zt=Lt;const Pt={class:"container"},Nt={class:"row"},Mt={class:"col"},Zt=(0,r._)("h1",{class:"mt-3"},"All Users",-1),Yt=(0,r._)("hr",null,null,-1),Kt={key:0,class:"table table-compact table-striped"},Rt=(0,r._)("thead",null,[(0,r._)("tr",null,[(0,r._)("th",null,"User"),(0,r._)("th",null,"Email"),(0,r._)("th",null,"Active"),(0,r._)("th",null,"Status")])],-1),Jt={key:0},Gt=(0,r._)("span",{class:"badge bg-success"},"Active",-1),Qt=[Gt],Xt={key:1},eo=(0,r._)("span",{class:"badge bg-danger"},"Inactive",-1),to=[eo],oo={key:2},ao={href:"javascript:void(0)"},ro=["onClick"],so={key:3},no=(0,r._)("span",{class:"badge bg-danger"},"Not logged in",-1),lo=[no],io={key:1};function uo(e,t,o,a,s,l){const i=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",Pt,[(0,r._)("div",Nt,[(0,r._)("div",Mt,[Zt,Yt,this.ready?((0,r.wg)(),(0,r.iD)("table",Kt,[Rt,(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(this.users,(e=>((0,r.wg)(),(0,r.iD)("tr",{key:e.id},[(0,r._)("td",null,[(0,r.Wm)(i,{to:`/admin/users/${e.id}`},{default:(0,r.w5)((()=>[(0,r.Uk)((0,n.zw)(e.last_name)+", "+(0,n.zw)(e.first_name),1)])),_:2},1032,["to"])]),(0,r._)("td",null,(0,n.zw)(e.email),1),1===e.active?((0,r.wg)(),(0,r.iD)("td",Jt,Qt)):((0,r.wg)(),(0,r.iD)("td",Xt,to)),e.token.id>0?((0,r.wg)(),(0,r.iD)("td",oo,[(0,r._)("a",ao,[(0,r._)("span",{class:"badge bg-success",onClick:t=>l.logUserOut(e.id)},"Logged in",8,ro)])])):((0,r.wg)(),(0,r.iD)("td",so,lo))])))),128))])])):((0,r.wg)(),(0,r.iD)("p",io,"Loading..."))])])])}var co={data(){return{users:[],ready:!1,store:q}},beforeMount(){ie.requireToken(),fetch("http://localhost:8082/admin/users",ie.requestOptions("")).then((e=>e.json())).then((e=>{e.error?Bt().alert({type:"error",text:e.message}):(this.users=e.data.users,this.ready=!0)})).catch((e=>{Bt().alert({type:"error",text:e})}))},methods:{logUserOut(e){e!==q.user.id?Bt().confirm({text:"Are you sure you want to log this user out?",submitText:"Log out",submitCallback:()=>{fetch(`http://localhost:8082/admin/log-user-out/${e}`,ie.requestOptions("")).then((e=>e.json())).then((e=>{e.error?(Bt().alert({type:"error",text:e.message}),this.$emit("error",e.message)):(this.$emit("success",e.message),this.$emit("forceUpdate"))})).catch((e=>{this.$emit("error",e)}))}}):this.$emit("error","you can't log youserf out")}}};const mo=(0,W.Z)(co,[["render",uo]]);var po=mo;const ho={class:"container"},vo={class:"row"},go={class:"col"},bo=(0,r._)("h1",{class:"mt-3"},"User",-1),ko=(0,r._)("hr",null,null,-1),fo={class:"form-check"},_o=(0,r._)("label",{class:"form-check-label",for:"user-active"},"Active",-1),wo={class:"form-check"},yo=(0,r._)("label",{class:"form-check-label",for:"user-active-2"},"Inactive",-1),Co=(0,r._)("hr",null,null,-1),Do={class:"float-start"},xo=(0,r._)("input",{type:"submit",class:"btn btn-primary me-2",value:"Save"},null,-1),$o=(0,r.Uk)("Cancel"),Uo={class:"float-end"},Io=(0,r._)("div",{class:"clearfix"},null,-1);function qo(e,t,o,s,n,l){const i=(0,r.up)("TextInputComponent"),u=(0,r.up)("router-link"),c=(0,r.up)("FormTagComponent");return(0,r.wg)(),(0,r.iD)("div",ho,[(0,r._)("div",vo,[(0,r._)("div",go,[bo,ko,(0,r.Wm)(c,{onUserEditEvent:l.submitHandler,name:"userform",event:"userEditEvent"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:n.user.first_name,"onUpdate:modelValue":t[0]||(t[0]=e=>n.user.first_name=e),type:"text",required:"true",label:"First Name",value:n.user.first_name,name:"first-name"},null,8,["modelValue","value"]),(0,r.Wm)(i,{modelValue:n.user.last_name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.user.last_name=e),type:"text",required:"true",label:"Last Name",value:n.user.last_name,name:"last-name"},null,8,["modelValue","value"]),(0,r.Wm)(i,{modelValue:n.user.email,"onUpdate:modelValue":t[2]||(t[2]=e=>n.user.email=e),type:"email",required:"true",label:"Email",value:n.user.email,name:"email"},null,8,["modelValue","value"]),0===this.user.id?((0,r.wg)(),(0,r.j4)(i,{key:0,modelValue:n.user.password,"onUpdate:modelValue":t[3]||(t[3]=e=>n.user.password=e),type:"password",required:"true",label:"Password",value:n.user.password,name:"password"},null,8,["modelValue","value"])):((0,r.wg)(),(0,r.j4)(i,{key:1,modelValue:n.user.password,"onUpdate:modelValue":t[4]||(t[4]=e=>n.user.password=e),type:"password",label:"Password",help:"Leave empty to keep existing password",value:n.user.password,name:"password"},null,8,["modelValue","value"])),(0,r._)("div",fo,[(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>n.user.active=e),class:"form-check-input",type:"radio",id:"user-active",value:1},null,512),[[a.G2,n.user.active]]),_o]),(0,r._)("div",wo,[(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>n.user.active=e),class:"form-check-input",type:"radio",id:"user-active-2",value:0},null,512),[[a.G2,n.user.active]]),yo]),Co,(0,r._)("div",Do,[xo,(0,r.Wm)(u,{to:"/admin/users",class:"btn btn-outline-secondary"},{default:(0,r.w5)((()=>[$o])),_:1})]),(0,r._)("div",Uo,[this.$route.params.userId>0&&parseInt(String(this.$route.params.userId),10)!==n.store.user.id?((0,r.wg)(),(0,r.iD)("a",{key:0,class:"btn btn-danger",href:"javascript:void(0);",onClick:t[7]||(t[7]=e=>l.confirmDelete(this.user.id))},"Delete")):(0,r.kq)("",!0)]),Io])),_:1},8,["onUserEditEvent"])])])])}var jo={beforeMount(){ie.requireToken(),parseInt(String(this.$route.params.userId),10)>0&&fetch(`http://localhost:8082/admin/users/get/${this.$route.params.userId}`,ie.requestOptions("")).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.user=e,this.user.password="")}))},data(){return{user:{id:0,first_name:"",last_name:"",email:"",password:"",active:0},store:q}},components:{FormTagComponent:Q,TextInputComponent:ne},methods:{submitHandler(){const e={id:parseInt(String(this.$route.params.userId),10),first_name:this.user.first_name,last_name:this.user.last_name,email:this.user.email,password:this.user.password,active:this.user.active};fetch("http://localhost:8082/admin/users/save",ie.requestOptions(e)).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.$emit("success","Changes saved"),Oo.push("/admin/users"))})).catch((e=>{this.$emit("error",e)}))},confirmDelete(e){Bt().confirm({text:"Are you sure you want to delete this user?",submitText:"Delete",submitCallback:function(){let t={id:e};fetch("http://localhost:8082/admin/users/delete",ie.requestOptions(t)).then((e=>e.json())).then((e=>{e.error?this.$emit("error",e.message):(this.$emit("success","User deleted"),Oo.push("/admin/users"))}))}})}}};const So=(0,W.Z)(jo,[["render",qo]]);var To=So;const Vo=[{path:"/",name:"Home",component:B},{path:"/login",name:"LoginComposition",component:de},{path:"/books",name:"BooksComposition",component:Fe},{path:"/book/:bookName",name:"BookComposition",component:Re},{path:"/admin/books",name:"BooksAdmin",component:nt},{path:"/admin/books/:bookId",name:"BookEdit",component:zt},{path:"/admin/users",name:"Users",component:po},{path:"/admin/users/:userId",name:"User",component:To}],Fo=(0,j.p7)({history:(0,j.PO)(),routes:Vo});Fo.beforeEach((()=>{ie.checkToken()}));var Oo=Fo,Ho={data(){return{store:q}},methods:{logout(){const e={token:q.token};fetch("http://localhost:8082/users/logout",ie.requestOptions(e)).then((e=>e.json())).then((e=>{e.error?console.log(e.message):(q.token="",q.user={},document.cookie="_site_data=; Path=/; SameSite=Strict; Secure; Expires=Thu, 01 Jan 1970 00:00:01 GMT;",Oo.push("/login"))}))}}};const Wo=(0,W.Z)(Ho,[["render",U]]);var Eo=Wo;const Bo={class:"d-flex align-items-center justify-content-center mt-5"};function Ao(e,t,o,a,s,l){return(0,r.wg)(),(0,r.iD)("footer",Bo," Copyright © "+(0,n.zw)((new Date).getFullYear()),1)}var Lo={};const zo=(0,W.Z)(Lo,[["render",Ao],["__scopeId","data-v-7576de88"]]);var Po=zo;const No=e=>document.cookie.split("; ").reduce(((t,o)=>{const a=o.split("=");return a[0]===e?decodeURIComponent(a[1]):t}),"");var Mo={name:"App",components:{Header:Eo,Footer:Po},data(){return{store:q,componentKey:0}},beforeMount(){let e=No("_site_data");if(""!==e){let t=JSON.parse(e);q.token=t.token.token,q.user={id:t.user.id,first_name:t.user.first_name,last_name:t.user.last_name,email:t.user.email}}},methods:{success(e){Bt().alert({type:"success",text:e})},error(e){Bt().alert({type:"error",text:e})},warning(e){Bt().alert({type:"warning",text:e})},forceUpdate(){this.componentKey+=1}}};const Zo=(0,W.Z)(Mo,[["render",s]]);var Yo=Zo;(0,a.ri)(Yo).use(Oo).mount("#app")}},t={};function o(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,a,r,s){if(!a){var n=1/0;for(c=0;c<e.length;c++){a=e[c][0],r=e[c][1],s=e[c][2];for(var l=!0,i=0;i<a.length;i++)(!1&s||n>=s)&&Object.keys(o.O).every((function(e){return o.O[e](a[i])}))?a.splice(i--,1):(l=!1,s<n&&(n=s));if(l){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[a,r,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.p="/"}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,s,n=a[0],l=a[1],i=a[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(i)var c=i(o)}for(t&&t(a);u<n.length;u++)s=n[u],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(c)},a=self["webpackChunkfrontend_vuejs"]=self["webpackChunkfrontend_vuejs"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(4769)}));a=o.O(a)})();
//# sourceMappingURL=app.850ba597.js.map